{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}
<h2 class="tekst">Catalogus</h2>

<div class="main">
  <!-- Search bar -->
    <form method="POST" class="searchForm">
      <input type="hidden" name="form_name" value="search" />
      <div class="input-group rounded" id="searchBar">
        <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search" aria-describedby="search-addon" name="search"/>
        <button type="submit" class="input-group-text border-0" id="search-addon">
          <i class="bi bi-search" id="searchicon"></i>
        </button>
      </div>
    </form>

    <!-- Filters -->
    <section class="filters">
      <form method="POST" id="filterForm" class="mb-3">
        <input type="hidden" name="form_name" value="sorteer" />
        <label for="sorteer">Sorteer:</label>
        <select id="sorteer" name="AZ" class="form-select">
          <option value="niet" {% if sortItems == 'niet' %} selected {% endif %}></option>
          <option value="AZ" {% if sortItems == 'AZ' %} selected {% endif %}>A-Z</option>
          <option value="ZA" {% if sortItems == 'ZA' %} selected {% endif %}>Z-A</option>
        </select>
        <br/>
        <!-- category -->
        <label><span style="font-weight: bold">Categorie:</span></label
        ><br/>

        <input type="checkbox" id="Audio" name="category" value="Audio" {% if 'Audio' in selected_categories %} checked {% endif %}/>
        <label for="Audio">Audio</label>
        <br/>
        <input type="checkbox" id="Belichting" name="category"value="Belichting" {% if 'Belichting' in selected_categories %} checked {% endif %}/>
        <label for="Belichting">Belichting</label>
        <br/>
        <input type="checkbox" id="Elektronica" name="category" value="Elektronica" {% if 'Elektronica' in selected_categories %} checked {% endif %}/>
        <label for="Elektronica">Elektronica</label>
        <br/>
        <input type="checkbox" id="Video" name="category" value="Video" {% if 'Video' in selected_categories %} checked {% endif %}/>
        <label for="Video">Video</label>
        <br/>
        <input type="checkbox" id="Varia" name="category" value="Varia" {% if 'Varia' in selected_categories %} checked {% endif %}/>
        <label for="Varia">Varia</label>
        <br/>
        <hr/>
        <label><span style="font-weight: bold">Merk:</span></label>
        <br/>
        <input type="checkbox" id="Apple" name="merk" value="Apple" {% if 'Apple' in selected_merk %} checked {% endif %}/>
        <label for="Apple">Apple</label>
        <br/>
        <input type="checkbox" id="Arduino" name="merk" value="Arduino" {% if 'Arduino' in selected_merk %} checked {% endif %}/>
        <label for="Arduino">Arduino</label>
        <br/>
        <input type="checkbox" id="Canon" name="merk" value="Canon" {% if 'Canon' in selected_merk %} checked {% endif %}/>
        <label for="Canon">Canon</label>
        <br/>
        <input type="checkbox" id="Bresser" name="merk" value="Bresser" {% if 'Bresser' in selected_merk %} checked {% endif %}/>
        <label for="Bresser">Bresser</label>
        <br/>
        <input type="checkbox" id="Rode" name="merk" value="Rode" {% if 'Rode' in selected_merk %} checked {% endif %}/>
        <label for="Rode">Rode</label>
        <br/>
        <hr/>
        <label><span style="font-weight: bold">Type:</span></label
        ><br/>
        <input type="checkbox" id="enkel_product" name="Type_product" value="enkel_product" {% if 'enkel_product' in selected_type %} checked {% endif %}/>
        <label for="enkel_product">enkel product</label>
        <br/>
        <input type="checkbox" id="set" name="Type_product" value="set" {% if 'set' in selected_type %} checked {% endif %}/>
        <label for="set">set</label>
        <br/>
        <input type="checkbox" id="accessoire" name="Type_product"value="accessoire" {% if 'accessoire' in selected_type %} checked {% endif %}/>
        <label for="accessoire">accessoires</label>
        <br/>
        <hr/> <!-- moet nog gedaan worden -->  
        
        <br>
        <label for="datums">Filter op datum:</label>
        <input class="form-control selecteerDatum" type="datetime-local" id="datums" name="datums" value="{{ datums }}"/>
        <br>
          <button type="submit" name="form_name" value="sorteer" class="btn btn-primary">Sorteer</button>
        </form>

      <script>
        // JavaScript to set the min attribute to today's date
        document.addEventListener('DOMContentLoaded', (event) => {
            let today = new Date().toISOString().split('T')[0];
            document.getElementById('begindatum').setAttribute('min', today);
            document.getElementById('einddatum').setAttribute('min', today);
      
            // Add an event listener to the 'begindatum' field
            document.getElementById('begindatum').addEventListener('change', function() {
                // When the begindatum changes, set the min attribute of the einddatum to the selected begindatum
                document.getElementById('einddatum').setAttribute('min', this.value);
            });
        });
      </script>
    </section>

  <!-- catalogus -->
  <section class="catalogus">
    {% for title, group in grouped_artikels.items() %} {% if group|length > 1 %}
    <!-- Carousel code voor als er meerdere van 1 artikel zijn -->
    <div class="card">
      <div
        id="carouselExampleIndicators{{ loop.index }}"
        class="carousel slide"
        data-interval="false"
      >
        <div class="carousel-inner">
          {% for artikel in group %}
          <!-- De card van het artikel zelf -->
          <div
            class="carousel-item {% if loop.first %}active{% endif %}"
            data-toggle="modal"
            data-target="#myModal{{ loop.index }}"
            data-title="{{ artikel.title }}"
            data-img="{{ url_for('static', filename='images/'+artikel.afbeelding) }}"
            data-desc="{{ artikel.beschrijving }}"
            data-brand="{{ artikel.merk }}"
          >
            <div class="cardcontent">
              <div class="cardimg">
                <img
                  src="{{ url_for('static', filename='images/' + artikel.afbeelding) }}"
                  class="card-img-top"
                  alt="afbeelding"
                />
              </div>

              <div class="card-body">
                <h5 class="card-title">{{ artikel.title }}</h5>
                <p class="card-text">{{ artikel.merk }}</p>
                <p class="card-text">{{ artikel.nummer }}</p>
                <p class="card-text">{{ artikel.category }}</p>
                <form method="POST" class="datumForm">
                  <div class="datumReserveer">
                    <input
                      class="form-control selecteerDatum card-button"
                      type="datetime-local"
                      placeholder="Selecteer datums"
                      name="datepicker"
                      data-item-id="{{ artikel.id }}"
                      data-user-id="{{ user.type_id }}"
                    />
                    <!-- Form om het artikel te reserveren -->
                    <input type="hidden" name="form_name" value="reserveer" />
                    <input type="hidden" name="artikel_id" value="{{ artikel.id }}"/>
                    <button
                      type="submit" class="btn btn-primary submitBtn card-button">Reserveer
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- Modal(Popup met extra info als je op het artikel klikt) -->
          <div
            class="modal fade myModal"
            id="myModal{{ loop.index }}"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="myModalLabel"></h5>
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="modal-left">
                    <img class="modal-img" src="" alt="Image" />
                  </div>
                  <div class="modal-right">
                    <p class="modal-desc"></p>
                    <p class="modal-brand"></p>
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-dismiss="modal"
                  >
                    Close
                  </button>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        <!-- Carousel buttons -->
        <a
          class="carousel-control-prev carouselBtn"
          href="#carouselExampleIndicators{{ loop.index }}"
          role="button"
          data-slide="prev"
        >
          <i class="fas fa-chevron-left"></i>
        </a>
        <a
          class="carousel-control-next carouselBtn"
          href="#carouselExampleIndicators{{ loop.index }}"
          role="button"
          data-slide="next"
        >
          <i class="fas fa-chevron-right"></i>
        </a>
      </div>
    </div>
    {% else %}
    <!-- Als er maar 1 exemplaar is van het artikel -->
    <div
      class="card"
      data-toggle="modal"
      data-target="#myModal{{ loop.index }}"
      data-title="{{ group[0].title }}"
      data-img="{{ url_for('static', filename='images/'+group[0].afbeelding) }}"
      data-desc="{{ group[0].beschrijving }}"
      data-brand="{{ group[0].merk }}"
    >
      <!-- Content van het artikel -->
      <div class="cardcontent">
        <div class="cardimg">
          <img
            src="{{ url_for('static', filename='images/'+group[0].afbeelding) }}"
            class="card-img-top"
            alt="afbeelding"
          />
        </div>

        <div class="card-body">
          <h5 class="card-title">{{ group[0].title }}</h5>
          <p class="card-text">{{ group[0].merk }}</p>
          <p class="card-text">{{ group[0].nummer }}</p>
          <p class="card-text">{{ group[0].category }}</p>
          <form method="POST" class="datumForm">
            <div class="datumReserveer">
              <input
                class="form-control selecteerDatum card-button"
                type="datetime-local"
                placeholder="Selecteer datums"
                name="datepicker"
                data-item-id="{{ group[0].id }}"
                data-user-id="{{ user.type_id }}"
              />
              <input type="hidden" name="form_name" value="reserveer" />
              <input
                type="hidden"
                name="artikel_id"
                value="{{ group[0].id }}"
              />
              <button
                type="submit"
                class="btn btn-primary submitBtn card-button"
              >
                Reserveer
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Modal voor het artikel -->
    <div
      class="modal fade myModal"
      id="myModal{{ loop.index }}"
      tabindex="-1"
      role="dialog"
      aria-labelledby="myModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="myModalLabel"></h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-left">
              <img class="modal-img" src="" alt="Image" />
              <h6>Merk:</h6>
              <p class="modal-brand"></p>
            </div>
            <div class="modal-right">
              <h6>Beschrijving:</h6>
              <p class="modal-desc"></p>
              
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Als er geen artikels gevonden zijn voor de zoekopdracht -->
    {% endif %} {% endfor %} {% if not grouped_artikels %}
    <h2>Geen artikels gevonden die voldoen aan de criteria.</h2>
    {% endif %}
  </section>
</div>
{% endblock %}

